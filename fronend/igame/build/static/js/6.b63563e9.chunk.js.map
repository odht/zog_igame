{"version":3,"sources":["../static/js/6.b63563e9.chunk.js","App/App2/Sign/ExistTeamForm.js"],"names":["webpackJsonp","1159","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_0_react___default","n","__WEBPACK_IMPORTED_MODULE_1_antd__","__WEBPACK_IMPORTED_MODULE_2_antd_mobile__","__WEBPACK_IMPORTED_MODULE_3__User_session__","__WEBPACK_IMPORTED_MODULE_4__OdooRpc_Game__","__WEBPACK_IMPORTED_MODULE_5__OdooRpc_GameTeam__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","FormItem","Item","Option","FormForSign","_React$Component","_ref","_temp","_this","_ret","this","_len","arguments","args","Array","_key","getPrototypeOf","apply","concat","state","eventDetail","myTeams","currentTeam","currentTeam2","mySelf","teamId","disabled","stateTeams","res","setState","players","filter","item","playername","get_name","id","info","requestFail","fail","onSubmit","e","preventDefault","teamSign","form","getFieldValue","forEach","obj","role","push","signEvent","registerFail","register_game","setToast","success","cancelSubmit","handleTeamSelect","val","setFieldsValue","leader","coach","player","handleCoach","handlePlayer","index","handlePlayerDe","validateTeamName","rule","callback","pattern","test","Error","validatePlayer","items","a","createElement","teamname","requestFai","get_own_teams","_this2","_props$form","getFieldProps","getFieldDecorator","layout","style","marginBottom","placeholder","defaultValue","notFoundContent","width","onChange","label","assign","rules","required","message","showSearch","onSelect","validator","mode","onDeselect","type","paddingLeft","paddingRight","marginRight","htmlType","onClick","Component","ExistTeamForm"],"mappings":"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","file":"static/js/6.b63563e9.chunk.js","sourcesContent":["webpackJsonp([6],{\n\n/***/ 1159:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_antd_mobile__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__User_session__ = __webpack_require__(130);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__OdooRpc_Game__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__OdooRpc_GameTeam__ = __webpack_require__(214);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}// import { Form, Select, Button, Input, Row, Col  } from 'antd';\n// import  { Game, GameTeam } from '../../Models/Models'\nvar FormItem=__WEBPACK_IMPORTED_MODULE_1_antd__[\"d\" /* Form */].Item;var Option=__WEBPACK_IMPORTED_MODULE_1_antd__[\"h\" /* Select */].Option;var FormForSign=function(_React$Component){_inherits(FormForSign,_React$Component);function FormForSign(){var _ref;var _temp,_this,_ret;_classCallCheck(this,FormForSign);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=FormForSign.__proto__||Object.getPrototypeOf(FormForSign)).call.apply(_ref,[this].concat(args))),_this),_this.state={eventDetail:_this.props.eventDetail,//要报名赛事的全部信息\nmyTeams:null,currentTeam:null,currentTeam2:null,mySelf:null,teamId:null,disabled:true},_this.stateTeams=function(res){if(res&&res.length!==0){_this.setState({myTeams:res,currentTeam:res[0].players.filter(function(item){return item.playername!==__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name();}),currentTeam2:res[0].players.filter(function(item){return item.playername!==__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name();}),mySelf:res[0].players.filter(function(item){return item.playername===__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name();})[0],teamId:res[0].id,disabled:false});}else{__WEBPACK_IMPORTED_MODULE_2_antd_mobile__[\"n\" /* Toast */].info('没有赛队信息，请先创建赛队！！',2);}},_this.requestFail=function(){__WEBPACK_IMPORTED_MODULE_2_antd_mobile__[\"n\" /* Toast */].fail('查询赛队失败，请稍后重试！！',1);},_this.onSubmit=function(e){e.preventDefault();var teamSign=[];_this.props.form.getFieldValue('player').forEach(function(item){var obj={};obj.id=item;obj.role='player';teamSign.push(obj);});teamSign.push({id:_this.props.form.getFieldValue('leader'),role:'leader'});teamSign.push({id:_this.props.form.getFieldValue('coach'),role:'coach'});// const m = Models.create();\n// m.query('exec', 'og.igame','register_game',{},this.signEvent,this.registerFail,this.state.eventDetail.id,this.state.teamId,teamSign);\nvar m=new __WEBPACK_IMPORTED_MODULE_4__OdooRpc_Game__[\"a\" /* default */](_this.signEvent,_this.registerFail);//说明：传入回调函数\nm.register_game(_this.state.eventDetail.id,_this.state.teamId,teamSign);//说明：调用Models里面定义好的方法，传入相应的参数\n},_this.signEvent=function(res){_this.props.setToast();__WEBPACK_IMPORTED_MODULE_2_antd_mobile__[\"n\" /* Toast */].success('报名成功，请到‘我-我的比赛’中查看',1);},_this.registerFail=function(){__WEBPACK_IMPORTED_MODULE_2_antd_mobile__[\"n\" /* Toast */].fail('报名失败，请稍后重试！！',1);},_this.cancelSubmit=function(){_this.props.cancelSubmit();},_this.handleTeamSelect=function(val){_this.setState({currentTeam:_this.state.myTeams.filter(function(item){return item.id===val;})[0].players.filter(function(item){return item.playername!==__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name();}),currentTeam2:_this.state.myTeams.filter(function(item){return item.id===val;})[0].players.filter(function(item){return item.playername!==__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name();}),teamId:val});_this.props.form.setFieldsValue({leader:null,coach:null,player:[]});},_this.handleCoach=function(key){_this.setState({currentTeam2:_this.state.myTeams.filter(function(item){return item.id===_this.state.teamId;})[0].players.filter(function(item){return item.playername!==__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name()&&item.id!==key;})});},_this.handlePlayer=function(key){_this.setState({currentTeam:_this.state.currentTeam.filter(function(item,index){return item.playername!==__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name()&&item.id!==key;})});},_this.handlePlayerDe=function(key){_this.setState({currentTeam:_this.state.currentTeam.concat(_this.state.currentTeam2.filter(function(item,index){return item.playername!==__WEBPACK_IMPORTED_MODULE_3__User_session__[\"a\" /* default */].get_name()&&item.id===key;}))});},_this.validateTeamName=function(rule,value,callback){var pattern=/[A-Za-z0-9_\\-\\u4e00-\\u9fa5]+/;if(value){if(pattern.test(value)&&value.length>2&&value.length<=10){callback();}else{callback(new Error('长度为3-10个字符，只能包含中文、数字、字母'));}}else{callback();}},_this.validatePlayer=function(rule,value,callback){if(value){if(value.length>1&&value.length<=6){callback();}else{callback(new Error('请选择2-6个队员'));}}else{callback();}},_this.items=function(state){var items=[];if(!state||state.length===0){return items=[];}else{if(state===_this.state.myTeams){state.forEach(function(item){items.push(__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(Option,{key:item.id,value:item.id},item.teamname));});}else{state.forEach(function(item){items.push(__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(Option,{key:item.id,value:item.id,disabled:false},'\\u59D3\\u540D\\uFF1A',item.playername,'\\uFF0C\\u8D5B\\u4E8B\\u8BC1\\u53F7\\uFF1A',item.id));});}}return items;},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(FormForSign,[{key:'componentDidMount',value:function componentDidMount(){// 请求赛队列表 \nvar m=new __WEBPACK_IMPORTED_MODULE_5__OdooRpc_GameTeam__[\"a\" /* default */](this.stateTeams,this.requestFai);//说明：传入回调函数\nm.get_own_teams();//说明：调用Models里面定义好的方法\n}// 提交表单，发送报名请求\n// 取消报名，返回选择报名方式页面 ★\n// 选择参赛队伍\n// 教练 ，值发生改变 ★\n// 队员 ，值发生改变 ★\n},{key:'render',value:function render(){var _this2=this;var _props$form=this.props.form,getFieldProps=_props$form.getFieldProps,getFieldDecorator=_props$form.getFieldDecorator;// const {getFieldProps, getFieldDecorator, getFieldsError, getFieldError, isFieldTouched } = this.props.form;\nreturn __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"d\" /* Form */],{layout:'vertical',onSubmit:this.onSubmit},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(FormItem,{style:{marginBottom:0}},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('span',null,'\\u8D5B\\u961F\\uFF1A'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"h\" /* Select */],{placeholder:'\\u9009\\u62E9\\u8D5B\\u961F',defaultValue:this.state.myTeams?this.state.myTeams[0].id:null,notFoundContent:'\\u6CA1\\u6709\\u8D5B\\u961F\\u4FE1\\u606F',style:{width:120},onChange:function onChange(key){return _this2.handleTeamSelect(key);}},this.items(this.state.myTeams))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(FormItem,{label:'\\u9886\\u961F',style:{marginBottom:0}},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"h\" /* Select */],Object.assign({disabled:this.state.disabled,placeholder:'\\u59D3\\u540D',notFoundContent:'\\u6CA1\\u6709\\u7528\\u6237\\u4FE1\\u606F',defaultValue:this.state.mySelf?this.state.mySelf.id:null,style:{width:290}},getFieldProps('leader')),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(Option,{key:this.state.mySelf?this.state.mySelf.id:null,value:this.state.mySelf?this.state.mySelf.id:null,disabled:false},this.state.mySelf?'姓名：'+this.state.mySelf.playername+'赛事证号：'+this.state.mySelf.id:'没有用户信息'))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(FormItem,{label:'\\u6559\\u7EC3',style:{marginBottom:0}},getFieldDecorator('coach',{rules:[{required:true,message:'请选择一名教练'}]})(__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"h\" /* Select */],{disabled:this.state.disabled,placeholder:'\\u59D3\\u540D',notFoundContent:'\\u6CA1\\u6709\\u7528\\u6237\\u4FE1\\u606F',showSearch:true,style:{width:290},onSelect:function onSelect(key){return _this2.handleCoach(key);}},this.items(this.state.currentTeam)))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(FormItem,{label:'\\u961F\\u5458',style:{marginBottom:0}},getFieldDecorator('player',{rules:[{required:true},{validator:this.validatePlayer}]})(__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"h\" /* Select */],{disabled:this.state.disabled,mode:'multiple',notFoundContent:'\\u6CA1\\u6709\\u7528\\u6237\\u4FE1\\u606F',placeholder:'\\u59D3\\u540D',showSearch:true,style:{width:290},onSelect:function onSelect(key){return _this2.handlePlayer(key);},onDeselect:function onDeselect(key){return _this2.handlePlayerDe(key);}},this.items(this.state.currentTeam2)))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(FormItem,null,__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"a\" /* Button */],{disabled:this.state.disabled,type:'primary',style:{paddingLeft:10,paddingRight:10,marginRight:10},htmlType:'submit'},'\\u63D0\\u4EA4'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"a\" /* Button */],{disabled:this.state.disabled,type:'danger',style:{paddingLeft:10,paddingRight:10},onClick:this.cancelSubmit},'\\u53D6\\u6D88')));}}]);return FormForSign;}(__WEBPACK_IMPORTED_MODULE_0_react___default.a.Component);var ExistTeamForm=__WEBPACK_IMPORTED_MODULE_1_antd__[\"d\" /* Form */].create()(FormForSign);/* harmony default export */ __webpack_exports__[\"default\"] = (ExistTeamForm);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/6.b63563e9.chunk.js","import React from 'react'\nimport { Form, Select, Button } from 'antd';\n// import { Form, Select, Button, Input, Row, Col  } from 'antd';\nimport {Toast} from 'antd-mobile'  \n\nimport session from '../../User/session'\n// import  { Game, GameTeam } from '../../Models/Models'\nimport Game from '../../OdooRpc/Game';\nimport GameTeam from '../../OdooRpc/GameTeam';\n\nconst FormItem = Form.Item;\nconst Option = Select.Option;\n\nclass FormForSign extends React.Component{\n    state={\n        eventDetail:this.props.eventDetail,//要报名赛事的全部信息\n        myTeams:null,\n        currentTeam:null,\n        currentTeam2:null,\n        mySelf:null,\n        teamId:null,\n        disabled:true\n    }\n\n    componentDidMount(){\n        // 请求赛队列表 \n        const m = new GameTeam(this.stateTeams,this.requestFai);        //说明：传入回调函数\n        m.get_own_teams();                                              //说明：调用Models里面定义好的方法\n    }\n    stateTeams=(res)=>{\n        if(res && res.length!==0){\n            this.setState({\n                myTeams:res,\n                currentTeam:res[0].players.filter( item => {return item.playername !== session.get_name()}),\n                currentTeam2:res[0].players.filter( item => {return item.playername !== session.get_name()}),\n                mySelf: res[0].players.filter( item => {return item.playername === session.get_name()})[0],\n                teamId:res[0].id,\n                disabled:false\n            });\n        }else{\n            Toast.info('没有赛队信息，请先创建赛队！！', 2);\n        }\n    }\n    requestFail=()=>{\n        Toast.fail('查询赛队失败，请稍后重试！！',1)\n    }\n    \n// 提交表单，发送报名请求\n    onSubmit=(e)=>{\n        e.preventDefault();\n        const teamSign = [];\n        this.props.form.getFieldValue('player').forEach((item)=>{\n            const obj={};\n            obj.id=item;\n            obj.role='player';\n            teamSign.push(obj);\n        });\n        teamSign.push({id:this.props.form.getFieldValue('leader'),role:'leader'})\n        teamSign.push({id:this.props.form.getFieldValue('coach'),role:'coach'})\n\n        // const m = Models.create();\n        // m.query('exec', 'og.igame','register_game',{},this.signEvent,this.registerFail,this.state.eventDetail.id,this.state.teamId,teamSign);\n\n        const m = new Game(this.signEvent,this.registerFail);                   //说明：传入回调函数\n        m.register_game(this.state.eventDetail.id,this.state.teamId,teamSign);  //说明：调用Models里面定义好的方法，传入相应的参数\n    }\n    signEvent =(res)=>{\n        this.props.setToast();\n        Toast.success('报名成功，请到‘我-我的比赛’中查看',1)\n    }\n    registerFail=()=>{\n        Toast.fail('报名失败，请稍后重试！！',1)\n    }\n    \n// 取消报名，返回选择报名方式页面 ★\n    cancelSubmit=()=>{\n        this.props.cancelSubmit();\n    }\n\n// 选择参赛队伍\n    handleTeamSelect=(val)=>{\n        this.setState({\n            currentTeam : this.state.myTeams.filter(item =>{\n                return item.id === val\n            })[0].players.filter( item => {return item.playername !== session.get_name()}),\n            currentTeam2 : this.state.myTeams.filter(item =>{\n                return item.id === val\n            })[0].players.filter( item => {return item.playername !== session.get_name()}),\n            teamId : val\n        });\n        this.props.form.setFieldsValue({\n            leader:null,\n            coach:null,\n            player:[]\n        })\n    }\n\n// 教练 ，值发生改变 ★\n    handleCoach = (key)=>{\n        this.setState({\n            currentTeam2:  this.state.myTeams.filter(item =>{\n                        return item.id === this.state.teamId\n                    })[0].players.filter(item=> {\n                            return item.playername !== session.get_name() && item.id !== key;\n                        })\n        })\n    }\n\n// 队员 ，值发生改变 ★\n    handlePlayer = (key)=>{\n        this.setState({\n            currentTeam:   this.state.currentTeam.filter((item,index) => {\n                            return item.playername !== session.get_name() && item.id !== key;\n                        })\n        })\n    }\n    handlePlayerDe = (key)=>{\n        this.setState({\n            currentTeam:   this.state.currentTeam.concat(\n                            this.state.currentTeam2.filter((item,index) => {\n                                return item.playername !== session.get_name() && item.id === key;\n                        }))\n        })\n    }\n\n    validateTeamName = (rule, value, callback) => {\n        let pattern=/[A-Za-z0-9_\\-\\u4e00-\\u9fa5]+/;\n        if(value){\n            if(pattern.test(value) && value.length > 2 && value.length <= 10){\n                callback();\n              } else {\n                callback(new Error('长度为3-10个字符，只能包含中文、数字、字母'));\n              }\n        }else{\n            callback();\n        }\n    }\n\n    validatePlayer = (rule, value, callback) => {\n        if(value){\n            if(value.length > 1 && value.length <= 6){\n                callback();\n              } else {\n                callback(new Error('请选择2-6个队员'));\n              }\n        }else{\n            callback();\n        }\n    }\n\n\n    items=(state)=>{\n        let items = [];\n        \n\t\tif(!state || state.length === 0 ) {\n            return items=[];\n        }\n        else {\n            if(state === this.state.myTeams){\n                state.forEach(item => {\n                    items.push(\n                        <Option key={item.id} value={item.id}>{item.teamname}</Option>\n                    );\n                });\n            }else{\n                state.forEach(item => {\n                    items.push(\n                        <Option key={item.id} value={item.id} disabled={false}>姓名：{item.playername}，赛事证号：{item.id}</Option>\n                    );\n                });\n            }\n        }\n        return items\n    }\n\n\n    render(){\n        const {getFieldProps, getFieldDecorator} = this.props.form;\n        // const {getFieldProps, getFieldDecorator, getFieldsError, getFieldError, isFieldTouched } = this.props.form;\n        \n        return(\n            <Form layout=\"vertical\" onSubmit={this.onSubmit}>\n                    <FormItem style={{marginBottom:0}} >\n                        <span>赛队：</span>\n                        <Select placeholder=\"选择赛队\" defaultValue={this.state.myTeams ? this.state.myTeams[0].id : null } notFoundContent=\"没有赛队信息\" style={{ width: 120 }} onChange={key => this.handleTeamSelect(key)}>\n                        {this.items(this.state.myTeams)}\n                        </Select>\n                    </FormItem>\n                    <FormItem label=\"领队\"  style={{marginBottom:0}} >   \n                        <Select disabled={this.state.disabled} placeholder=\"姓名\" notFoundContent=\"没有用户信息\" defaultValue={this.state.mySelf ? this.state.mySelf.id :null } style={{ width: 290 }} {...getFieldProps('leader')}>\n                            <Option key={this.state.mySelf ? this.state.mySelf.id :null } value={this.state.mySelf ? this.state.mySelf.id :null} disabled={false}>{this.state.mySelf ? '姓名：' + this.state.mySelf.playername + '赛事证号：' +  this.state.mySelf.id :'没有用户信息'}</Option>\n                        </Select>  \n                    </FormItem>\n                    <FormItem label=\"教练\"  style={{marginBottom:0}}>  \n                        {getFieldDecorator('coach', {\n                            rules: [{ required: true ,message:'请选择一名教练'}],\n                        })( \n                            <Select  disabled={this.state.disabled}  placeholder=\"姓名\" notFoundContent=\"没有用户信息\" showSearch={true} style={{ width: 290 }} onSelect={key => this.handleCoach(key)}>\n                            {this.items(this.state.currentTeam)}\n                            </Select>   \n                        )} \n                    </FormItem>\n                    <FormItem label=\"队员\"  style={{marginBottom:0}}>   \n                        {getFieldDecorator('player', {\n                            rules: [\n                                { required: true},\n                                { validator: this.validatePlayer }\n                            ],\n                        })(\n                            <Select  disabled={this.state.disabled} mode=\"multiple\" notFoundContent=\"没有用户信息\" placeholder=\"姓名\" showSearch={true} style={{ width: 290 }} onSelect={key => this.handlePlayer(key)} onDeselect={key => this.handlePlayerDe(key)}>\n                            {this.items(this.state.currentTeam2)}\n                            </Select>  \n                        )}\n                    </FormItem>     \n                    <FormItem>\n                        <Button  disabled={this.state.disabled} type=\"primary\" style={{paddingLeft:10, paddingRight:10, marginRight:10}} htmlType=\"submit\">提交</Button>\n                        <Button  disabled={this.state.disabled} type=\"danger\" style={{paddingLeft:10, paddingRight:10}} onClick={this.cancelSubmit}>取消</Button>\n                    </FormItem>\n                </Form>      \n        )\n    }\n}\n\nconst ExistTeamForm = Form.create()(FormForSign);\n\nexport default ExistTeamForm;\n\n\n\n// WEBPACK FOOTER //\n// ./src/App/App2/Sign/ExistTeamForm.js"],"sourceRoot":""}